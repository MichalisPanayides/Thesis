\section{Data Collection}\label{sec:data_collection}

The data presented in this chapter were collected by solving the game theoretic
model from the interaction of the two EDs and the EMS.
The collected data are the matrices \(A, B\) and \(R\) described
in Section~\ref{sec:queueing_systems_and_normal_form_games}.
Each triplet of matrices \((A, B, R)\) was generated by solving the
corresponding game for a different set of parameters.

Different values of the parameters were used to generate this dataset.
The parameters that were changed throughout these experiments are listed in
Table~\ref{tab:data_collection_parameters}.

\begin{table}[H]
    \centering
    \caption{Data collection: Parameters}
    \begin{tabular}{|c|c|}
        \hline
        Parameter & Description \\
        \hline
        \(\lambda_2\) & Arrival rate of patients in EMS \\
        \(\alpha\) & Weight of lost individuals over time blocked \\
        \(t\) & Time target for the EDs \\
        \(\lambda_1^A\) & Arrival rate of patients in ED \(A\) \\
        \(\lambda_1^B\) & Arrival rate of patients in ED \(B\) \\
        \(\mu^A\) & Service rate of patients in ED \(A\) \\
        \(\mu^B\) & Service rate of patients in ED \(B\) \\
        \(C^A\) & Number of servers in ED \(A\) \\
        \(C^B\) & Number of servers in ED \(B\) \\
        \(N^A\) & Maximum capacity in ED \(A\) \\
        \(N^B\) & Maximum capacity in ED \(B\) \\
        \(M^A\) & Maximum capacity of parking space in ED \(A\) \\
        \(M^B\) & Maximum capacity of parking space in ED \(B\) \\
        \hline
    \end{tabular}
    \label{tab:data_collection_parameters}
\end{table}

Overall, \(5,\!160,\!404\) different sets of parameters were used.
For each parameter set, the script solves the game and stores the resulting
entries of the matrices \((A, B, R)\) as well as the parameters used to generate
them in a sub-directory of the \texttt{data} directory.
All parameter values of each parameter set, along with the corresponding values
of \(A, B\) and \(R\), are mapped to a unique fixed-size hash value which is
used as the name of the sub-directory for that parameter set.
The hash function that is used for this operation is the MD5 message-digest
algorithm~\cite{rivest1992md5}.

Having the name of the sub-directory for the current parameter set, the
resulting matrices are stored in a compressed \texttt{.npz} file in that
sub-directory.
The \texttt{.npz} file format is a zipped archive of files
named after the variables they contain, which are stored using numpy's
\texttt{savez\_compressed} function~\cite{2020NumPy-Array}.
The \texttt{.npz} files can be loaded using numpy's
\texttt{load} function.
In addition, to the \texttt{.npz} file, a
\texttt{README.md} file containing general instructions and a
\texttt{.csv} file containing the value of each parameter is
also stored in each sub-directory.
The code snippet in~\ref{lst:compressed_data} shows an example of how the data
are stored and loaded using numpy.

\newpage

\definecolor{invisiblecomments}{RGB}{253, 246, 220}
\begin{lstlisting}[
    style=pystyle,
    caption={Example of saving and loading compressed data},
    label={lst:compressed_data},
    commentstyle=\color{invisiblecomments}
]
>>> import numpy as np
>>> array_1, array_2 = np.arange(10), np.arange(10, 20)
>>> np.savez_compressed(
...     "demo", array_1=array_1, array_2=array_2
... ) # doctest: +SKIP
>>> loaded_file = np.load("demo.npz") # doctest: +SKIP
>>> loaded_file["array_1"] # doctest: +SKIP
array([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
>>> loaded_file["array_2"] # doctest: +SKIP
array([10, 11, 12, 13, 14, 15, 16, 17, 18, 19])

\end{lstlisting}

Apart from every sub-directory containing the data for a specific parameter set,
there is also a sub-directory named \texttt{\_parameters}.
This sub-directory contains a \texttt{.csv} file containing the
values of all parameters used in the experiments along with their corresponding
hash values.
This file can be used to map the hash values of the sub-directories to the
corresponding parameter values.
Consider the first \(5\) entries of the \texttt{.csv} file
from the \texttt{\_parameters} sub-directory and the first
\(5\) directories in the \texttt{data} directory.

\begin{table}[H]
    \centering
    \footnotesize
    \caption{Contents of \texttt{\_parameters/main.csv} file}
    \begin{tabular}{|cccccccccccccl|}
        \hline
        0 & 5 & 4 & 0 & 0 & 0.1 & 2 & 3 & 3 & 2 & 6 & 7 & 0 &
        0c2d6a2e23de39d69ffb3b2a18d33692 \\
        0 & 5 & 4 & 0 & 0 & 0.1 & 2 & 3 & 3 & 2 & 6 & 7 & 1 &
        8268e1967541e5d8edff3f3f00a4cfb8 \\
        0 & 5 & 4 & 0 & 0 & 0.1 & 2 & 3 & 3 & 2 & 6 & 7 & 2 &
        95d86d6bdca819eff8acc3d7a9297fd5 \\
        0 & 5 & 4 & 0 & 0 & 0.1 & 2 & 3 & 3 & 2 & 6 & 7 & 3 &
        b60ba099d5eabf6f07a9d9a81a2bab59 \\
        0 & 5 & 4 & 0 & 0 & 0.1 & 2 & 3 & 3 & 2 & 6 & 7 & 4 &
        2f542f3e30736267ace3bb24a45de427 \\
        \hline
    \end{tabular}
    \label{tab:parameters_csv}
\end{table}

The corresponding sub-directories of the \texttt{data}
directory are shown in the tree structure in Figure~\ref{fig:data_directory}:

\begin{figure}[H]
    \dirtree{%
        .1 data.
        .2 0c2d6a2e23de39d69ffb3b2a18d33692.
        .3 main.csv.
        .3 main.npz.
        .3 README.md.
        .2 8268e1967541e5d8edff3f3f00a4cfb8.
        .3 main.csv.
        .3 main.npz.
        .3 README.md.
        .2 95d86d6bdca819eff8acc3d7a9297fd5.
        .3 main.csv.
        .3 main.npz.
        .3 README.md.
        .2 b60ba099d5eabf6f07a9d9a81a2bab59.
        .3 main.csv.
        .3 main.npz.
        .3 README.md.
        .2 2f542f3e30736267ace3bb24a45de427.
        .3 main.csv.
        .3 main.npz.
        .3 README.md.
    }
    \caption{Structure of the \texttt{data} directory}
    \label{fig:data_directory}
\end{figure}
    
The \texttt{main.csv} file in each sub-directory contains the values of the
parameters used to generate the data in that sub-directory.
The \texttt{main.npz} file contains the compressed entries of the matrices
\(A, B\) and \(R\).
The complete dataset along with the scripts used to generate it have been
archived using \url{www.zenodo.org} and can be found with the following DOI:
\url{10.5281/zenodo.7501988}~\cite{michalis_panayides_2023_7555285}.
